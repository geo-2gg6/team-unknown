<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Privacy Protection App{% endblock %}</title>
</head>
<body style="margin:0; padding:0; background:#e5e7eb;">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="w-full max-w-md mx-auto mt-4">
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }} mb-2">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
            <div id="alerts" class="w-full max-w-sm mx-auto mt-4"></div>
            {% block content %}{% endblock %}
            <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    var socket = io();
                    var alerts = document.getElementById('alerts');
                    socket.on('new_alert', function(data) {
                        var item = document.createElement('div');
                        item.className = 'bg-white/10 p-4 rounded-xl flex flex-col mb-2';
                        item.innerHTML = `
                            <div class="font-bold text-lg">${data.event_type}</div>
                            <div class="text-sm text-gray-300">${data.timestamp}</div>
                            <div class="mt-1 text-white/80">${data.details}</div>
                        `;
                        alerts.prepend(item);
                    });
                });
            </script>
</body>
</html>
